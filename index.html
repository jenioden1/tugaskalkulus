<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kalkulator Persamaan Kuadrat</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
      }

      h1 {
        color: #333;
      }

      .calculator-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
      }

      .input-container {
        display: flex;
        margin: 10px;
      }

      input {
        margin: 5px;
        padding: 5px;
      }

      button {
        margin: 5px;
        padding: 5px;
        cursor: pointer;
      }

      .result-container {
        margin: 10px;
      }

      .chart-container {
        border: 1px solid #ccc;
      }

      .history-container {
        margin: 20px;
        text-align: left;
      }

      ul {
        list-style: none;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <h1>Kalkulator Persamaan Kuadrat</h1>
    <div class="calculator-container">
      <div class="input-container">
        <input type="number" id="a" placeholder="Masukkan nilai a" />
        <input type="number" id="b" placeholder="Masukkan nilai b" />
        <input type="number" id="c" placeholder="Masukkan nilai c" />
      </div>
      <button id="calculateButton">Hitung</button>
      <button id="resetButton">Reset</button>
      <button id="zoomInButton">Zoom In</button>
      <button id="zoomOutButton">Zoom Out</button>
      <div class="result-container">
        <p id="result"></p>
        <p id="extremePoint"></p>
      </div>
      <div class="chart-container">
        <canvas id="quadraticChart" width="800" height="800"></canvas>
      </div>
      <div class="history-container">
        <h2>History Pengerjaan:</h2>
        <ul id="history"></ul>
      </div>
    </div>
    <script>
      const calculateButton = document.getElementById("calculateButton");
      const resetButton = document.getElementById("resetButton");
      const zoomInButton = document.getElementById("zoomInButton");
      const zoomOutButton = document.getElementById("zoomOutButton");
      const resultElement = document.getElementById("result");
      const extremePointElement = document.getElementById("extremePoint");
      const canvas = document.getElementById("quadraticChart");
      const ctx = canvas.getContext("2d");
      const historyElement = document.getElementById("history");
      let zoom = 1;
      let a, b, c; // Variabel untuk menyimpan nilai a, b, c
      let roots = []; // Variabel untuk menyimpan akar-akar

      function calculateQuadratic() {
        a = parseFloat(document.getElementById("a").value);
        b = parseFloat(document.getElementById("b").value);
        c = parseFloat(document.getElementById("c").value);

        if (isNaN(a) || isNaN(b) || isNaN(c)) {
          resultElement.textContent =
            "Harap masukkan nilai a, b, dan c yang valid.";
          return;
        }

        historyElement.innerHTML = "";

        const discriminant = b ** 2 - 4 * a * c;

        if (discriminant > 0) {
          const root1 = (-b + Math.sqrt(discriminant)) / (2 * a);
          const root2 = (-b - Math.sqrt(discriminant)) / (2 * a);
          const result = `Akar-akar persamaan: x1 = ${root1.toFixed(
            2
          )} dan x2 = ${root2.toFixed(2)}`;
          resultElement.textContent = result;
          const extremeX = -b / (2 * a);
          const extremeY = a * extremeX * extremeX + b * extremeX + c;
          const extremeResult = `Titik Ekstremum: x = ${extremeX.toFixed(
            2
          )}, y = ${extremeY.toFixed(2)}`;
          extremePointElement.textContent = extremeResult;
          roots = [root1, root2];
          drawQuadraticChart();
          addToHistory(a, b, c, result, extremeResult);
        } else if (discriminant === 0) {
          const root = -b / (2 * a);
          const result = `Satu akar ganda: x = ${root.toFixed(2)}`;
          resultElement.textContent = result;
          const extremeX = -b / (2 * a);
          const extremeY = a * extremeX * extremeX + b * extremeX + c;
          const extremeResult = `Titik Ekstremum: x = ${extremeX.toFixed(
            2
          )}, y = ${extremeY.toFixed(2)}`;
          extremePointElement.textContent = extremeResult;
          roots = [root];
          drawQuadraticChart();
          addToHistory(a, b, c, result, extremeResult);
        } else {
          const result = "Persamaan tidak memiliki akar real.";
          resultElement.textContent = result;
          extremePointElement.textContent = "";
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          addToHistory(a, b, c, result, "");
          roots = [];
        }
      }

      calculateButton.addEventListener("click", calculateQuadratic);

      resetButton.addEventListener("click", function () {
        document.getElementById("a").value = "";
        document.getElementById("b").value = "";
        document.getElementById("c").value = "";
        resultElement.textContent = "";
        extremePointElement.textContent = "";
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        historyElement.innerHTML = "";
        a = b = c = undefined; // Reset nilai a, b, c
        roots = []; // Reset akar-akar
      });

      zoomInButton.addEventListener("click", function () {
        zoom *= 1.5; // Faktor perbesaran
        drawQuadraticChart();
      });

      zoomOutButton.addEventListener("click", function () {
        zoom /= 1.5; // Faktor perkecilan
        drawQuadraticChart();
      });

      function drawQuadraticChart() {
        if (
          typeof a === "undefined" ||
          typeof b === "undefined" ||
          typeof c === "undefined"
        ) {
          return; // Tidak menggambar jika nilai a, b, atau c belum diinput
        }

        const data = [];
        for (let x = -100; x <= 100; x += 0.1) {
          const y = a * x * x + b * x + c;
          data.push({ x, y });
        }

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, canvas.height / 2);
        ctx.lineTo(canvas.width, canvas.height / 2);
        ctx.moveTo(canvas.width / 2, 0);
        ctx.lineTo(canvas.width / 2, canvas.height);
        ctx.stroke();

        ctx.fillStyle = "black";
        ctx.font = "12px Arial";

        for (let i = -100; i <= 100; i++) {
          ctx.fillText(
            i,
            i * 20 * zoom + canvas.width / 2 - 5,
            canvas.height / 2 + 15
          );
        }

        for (let i = -100; i <= 100; i++) {
          ctx.fillText(
            -i,
            canvas.width / 2 + 10,
            -i * 20 * zoom + canvas.height / 2 + 5
          );
        }

        ctx.fillStyle = "black";
        ctx.beginPath();
        for (const root of roots) {
          ctx.arc(
            root * 20 * zoom + canvas.width / 2,
            canvas.height / 2,
            6,
            0,
            Math.PI * 2
          );
          ctx.fill();
        }

        ctx.strokeStyle = "blue";
        ctx.lineWidth = 2;

        for (let i = 0; i < data.length - 1; i++) {
          ctx.beginPath();
          ctx.moveTo(
            data[i].x * 20 * zoom + canvas.width / 2,
            -data[i].y * 20 * zoom + canvas.height / 2
          );
          ctx.lineTo(
            data[i + 1].x * 20 * zoom + canvas.width / 2,
            -data[i + 1].y * 20 * zoom + canvas.height / 2
          );
          ctx.stroke();
        }
      }

      function addToHistory(a, b, c, result, extremeResult) {
        const historyItem = document.createElement("li");
        historyItem.textContent = `Persamaan: ${a}x^2 + ${b}x + ${c} - ${result} - ${extremeResult}`;
        historyElement.appendChild(historyItem);
        resultElement.textContent = "";
        extremePointElement.textContent = "";
      }
    </script>
  </body>
</html>
